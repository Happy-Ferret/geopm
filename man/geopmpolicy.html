Content-type: text/html

<HTML><HEAD><TITLE>Manpage of GEOPMPOLICY</TITLE>
</HEAD><BODY>
<H1>GEOPMPOLICY</H1>
Section: GEOPM (3)<BR>Updated: 2015-10-16<BR><A HREF="#index">Index</A>
<A HREF="/man/man2html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

geopmpolicy - geopm configuration creator and static mode enforcer
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="lbAD">&nbsp;</A>
<H3>CREATE CONFIGURATION:</H3>

<B>geopmpolicy -c -f</B> output <B>-m</B> mode <B>-d</B> key0:value0,key1:value1...

<A NAME="lbAE">&nbsp;</A>
<H3>ENFORCE POLICY:</H3>

<B>geopmpolicy -e</B> (<B>-f</B> input | <B>-m</B> mode <B>-d</B> key0:value0,key1:value1...)

<A NAME="lbAF">&nbsp;</A>
<H3>SAVE MSR:</H3>

<B>geopmpolicy -s</B> [<B>-f</B> output]

<A NAME="lbAG">&nbsp;</A>
<H3>RESTORE MSR:</H3>

<B>geopmpolicy -r</B> [<B>-f</B> input]

<A NAME="lbAH">&nbsp;</A>
<H3>CREATE MSR WHITELIST:</H3>

<B>geopmpolicy -w</B> [<B>-f</B> output]

<A NAME="lbAI">&nbsp;</A>
<H3>PRINT VERSION OR HELP:</H3>

<B>geopmpolicy --version</B>|<B>--help</B>

<A NAME="lbAJ">&nbsp;</A>
<H2>DESCRIPTION</H2>

<P>
The
<B>geopmpolicy</B>

application can be used for five purposes: to create a
<B><A HREF="geopm.html">geopm</A></B>(3)

configuration file
(<B>-c</B>),

enforce a static power policy
(<B>-e</B>),

save to a file the state of
all MSR values that
<B><A HREF="geopm.html">geopm</A></B>(3)

may modify
(<B>-s</B>),

restore the MSR values from a saved state file
(<B>-r</B>),

or create a MSR whitelist for the Linux MSR driver
(<B>-w</B>).

The
geopmpolicy application also respects the standard
<B>--version</B> and <B>--help</B>

options for printing the geopm version or a brief message about
usage.  The output from using the
<B>-c</B>

option to create a configuration file can be used as the input for a
subsequent call to
<B>geopmpolicy</B>

with the
<B>-e</B>

option, and this file can also be used to configure
<B><A HREF="geopmctl.html">geopmctl</A></B>(3)

and the
<B><A HREF="geopm_ctl_c.html">geopm_ctl_c</A></B>(3)

interfaces.  Through this use of
<B>geopmpolicy</B>

a resource manager can configure
<B><A HREF="geopmctl.html">geopmctl</A></B>(3)

through a plug-in without introducing a linking dependency between geopm and
the resource manager (as is required with the
<B><A HREF="geopm_policy_c.html">geopm_policy_c</A></B>(3)

interface).  This enables a set of
<B><A HREF="geopmctl.html">geopmctl</A></B>(3)

features which can be described through a &quot;mode&quot; selection flag and a
&quot;dictionary&quot; flag for modifying the behavior of the mode by matching key
strings to value strings.
<B>geopmpolicy</B>

can also be used to enforce static power modes described in the
<B>MODES</B>

sections below.
<A NAME="lbAK">&nbsp;</A>
<H2>OPTIONS</H2>

<DL COMPACT>
<DT><B>--help</B>

<DD>
<BR>

Print brief summary of the command line usage information, then exit.
<DT><B>--version</B>

<DD>
<BR>

Print version of
<B><A HREF="geopm.html">geopm</A></B>(3)

to standard output, then exit.
<DT><B>-c</B>

<DD>
<BR>

Create a
<B><A HREF="geopm.html">geopm</A></B>(3)

configuration file,
<B>-f</B>

must be specified when using this option which gives the path to the output
configuration file.
<DT><B>-e</B>

<DD>
<BR>

Enforce a static power mode, this mode can be specified with the
<B>-m</B> and <B>-d</B>

options or the
<B>-f</B>

option.
<DT><B>-s</B>

<DD>
<BR>

Create an in MSR save state file for all MSR values that
<B><A HREF="geopm.html">geopm</A></B>(3)

may modify.  The output file may be specified with the
<B>-f</B>

option.
<DT><B>-r</B>

<DD>
<BR>

Restore the MSR values that are recored in an existing MSR save state file.
The input file may be specified with the
<B>-f</B>

option.
<DT><B>-w</B>

<DD>
<BR>

Create a Linux MSR driver whitelist file for the current platform, if
<B>-f</B>

is not specified when using this option, the whitelist will be printed to
stdout.  This whitelist is the minimum set of MSR register privileges required
to enable all geopm functionality.  Enabling user access to these registers
may have security implications on a multi-user system.  Each line of the
whitelist output ends with a name describing the register as derived from the
Intel (R) Software Developer's Manual.  Please cross-reference Intel (R)
Software Developer's Manual to get details about the security implications of
the whitelist before enabling user access.
<DT><B>-m</B> mode

<DD>
<BR>

Power management mode, must be one of those described in the
<B>MODES</B>

section below.  The static modes do not require the geopm runtime to be
running concurrently with the primary computational application, where as
dynamic modes do have a runtime requirement on geopm.
<DT><B>-d</B> key0:value0,key1:value1

<DD>
<BR>

Specifies a dictionary of key value pairs which modify the behavior of a
mode.  The key and value options for each mode are described in the
<B>MODES</B>

sections below.


<DT><B>-f</B> file_path

<DD>
<BR>

When used with
<B>-c</B> or <B>-s</B>

file_path is an output file.  When used with
<B>-e</B> or <B>-r</B>

file_path is an input file.  This is a
<B><A HREF="geopm.html">geopm</A></B>(3)

configuration file when used with
<B>-c</B> or <B>-e</B>

and an MSR save state file when used with
<B>-s</B> or <B>-r</B>.

<P>
</DL>
<A NAME="lbAL">&nbsp;</A>
<H2>MODES</H2>

<DL COMPACT>
<DT><B>tdp_balance_static</B>

<DD>
<BR>

Implements the GEOPM_MODE_TDP_BALANCE_STATIC mode described in the
<B><A HREF="geopm_policy_c.html">geopm_policy_c</A></B>(3)

man page in the
<B>STATIC MODES</B>

section.  The only key required to be passed to
the
<B>-d</B>

flag is the &quot;tdp_percent&quot; key which has a value that is the percent (0-100) of
the Thermal Design Power at which to run each processor under RAPL control.
All other keys are ignored.
<DT><B>freq_uniform_static</B>

<DD>
<BR>

Implements the GEOPM_MODE_FREQ_UNIFORM_STATIC mode described in the
<B><A HREF="geopm_policy_c.html">geopm_policy_c</A></B>(3)

man page in the
<B>STATIC MODES</B>

section.  The only key required to be passed to
the
<B>-d</B>

flag is the &quot;cpu_mhz&quot; key which has a value that is the CPU frequency in
units of MHz.  All other keys are ignored.
<DT><B>freq_hybrid_static</B>

<DD>
<BR>

Implements the GEOPM_MODE_FREQ_HYBRID_STATIC mode described in the
<B><A HREF="geopm_policy_c.html">geopm_policy_c</A></B>(3)

man page in the
<B>STATIC MODES</B>

section.  There are three keys required to be
passed to the
<B>-d</B>

flag for the freq_hybrid mode: &quot;cpu_mhz&quot; giving operating frequency for
restrained CPUs in units of MHz, &quot;num_cpu_max_perf&quot; giving the number of CPUs
running at maximum performance, and &quot;affinity&quot; which can have a value of
&quot;compact&quot; or &quot;scatter&quot; describing the distribution of the CPUs running at
maximum performance.  All other keys are ignored.
<DT><B>perf_balance_dynamic</B>

<DD>
Implements the GEOPM_MODE_PERF_BALANCE_DYNAMIC mode described in the
<B><A HREF="geopm_policy_c.html">geopm_policy_c</A></B>(3)

man page in the
<B>DYNAMIC MODES</B>

section.  The only key required to be passed to
the
<B>-d</B>

flag is the &quot;power_budget&quot; which is the power budget in units of Watts for all
compute nodes allocated to the job. All other keys are ignored.
<DT><B>freq_uniform_dynamic</B>

<DD>
Implements the GEOPM_MODE_FREQ_UNIFORM_DYNAMIC mode described in the
<B><A HREF="geopm_policy_c.html">geopm_policy_c</A></B>(3)

man page in the
<B>DYNAMIC MODES</B>

section.  The only key required to be passed to
the
<B>-d</B>

flag is the &quot;power_budget&quot; which is the power budget in units of Watts for all
compute nodes allocated to the job. All other keys are ignored.
<DT><B>freq_hybrid_dynamic</B>

<DD>
Implements the GEOPM_MODE_FREQ_HYBRID_DYNAMIC mode described in the
<B><A HREF="geopm_policy_c.html">geopm_policy_c</A></B>(3)

man page in the
<B>DYNAMIC MODES</B>

section.  There are three keys required to be passed to the
<B>-d</B>

flag for the freq_hybrid mode: &quot;power_budget&quot; which is the power budget in
units of Watts for all compute nodes allocated to the job , &quot;num_cpu_max_perf&quot;
giving the number of CPUs running at maximum performance, and &quot;affinity&quot; which
can have a value of &quot;compact&quot; or &quot;scatter&quot; describing the distribution of the
CPUs running at maximum performance.  All other keys are ignored.
</DL>
<A NAME="lbAM">&nbsp;</A>
<H2>EXAMPLES</H2>

<DL COMPACT>
<DT>Create a configuration file which disables power management with RAPL:<DD>
<BR>

$ geopmpolicy -c -f geopm.conf -m tdp_balance_static -d tdp_percent:100
<DT>Create a configuration file for a fixed frequency of 1.5 GHz:<DD>
<BR>

$ geopmpolicy -c -f geopm.conf -m freq_uniform_static -d cpu_freq:1500
<DT>Create a configuration file for a hybrid frequency of 2.5 GHz where 4 cores are unconstrained and using scatter distribution:<DD>
<BR>

$ geopmpolicy -c -f geopm.conf -m freq_hybrid_static \
<BR>

<BR>&nbsp;&nbsp;-d&nbsp;cpu_freq:2500,num_cpu_max_perf:4,affinity:scatter
<DT>Create a configuration file for all processors to run at 75% of the Thermal Design Power:<DD>
<BR>

$ geopmpolicy -c -f geopm.conf -m tdp_balance_static -d tdp_percent:75
<DT>Create a configuration file for global energy optimization with a power budget of 1 MWatt:<DD>
<BR>

$ geopmpolicy -c -f geopm.conf -m perf_balance_dynamic -d power_budget:1000000
<DT>Enforce a static policy defined in a preexisting configuration file:<DD>
<BR>

$ geopmpolicy -e -f geopm.conf
<DT>Enforce a static policy where all processors to run at 75% of the Thermal Design Power:<DD>
<BR>

$ geopmpolicy -e -m tdp_balance_static -d tdp_percent:75
<DT>Save off the current state of the system MSRs:<DD>
<BR>

$ geopmpolicy -s -f geopm_restore.log
<DT>Restore the system MSRs to their previous state:<DD>
<BR>

$ geopmpolicy -r -f geopm_restore.log
<DT>Output a MSR whitelist file for use with the Linux MSR driver:<DD>
<BR>

$ geopmpolicy -w -f msr_whitelist.conf
</DL>
<A NAME="lbAN">&nbsp;</A>
<H2>COPYRIGHT</H2>

Copyright (C) 2015 Intel Corporation. All rights reserved.
<A NAME="lbAO">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="geopm.html">geopm</A></B>(3),

<B><A HREF="geopm_ctl_c.html">geopm_ctl_c</A></B>(3),

<B><A HREF="geopm_error.html">geopm_error</A></B>(3),

<B><A HREF="geopm_omp.html">geopm_omp</A></B>(3),

<B><A HREF="geopm_policy_c.html">geopm_policy_c</A></B>(3),

<B><A HREF="geopm_prof_c.html">geopm_prof_c</A></B>(3),

<B><A HREF="geopm_version.html">geopm_version</A></B>(3),

<B><A HREF="geopmctl.html">geopmctl</A></B>(3),

<B><A HREF="geopmkey.html">geopmkey</A></B>(3)

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DL>
<DT><A HREF="#lbAD">CREATE CONFIGURATION:</A><DD>
<DT><A HREF="#lbAE">ENFORCE POLICY:</A><DD>
<DT><A HREF="#lbAF">SAVE MSR:</A><DD>
<DT><A HREF="#lbAG">RESTORE MSR:</A><DD>
<DT><A HREF="#lbAH">CREATE MSR WHITELIST:</A><DD>
<DT><A HREF="#lbAI">PRINT VERSION OR HELP:</A><DD>
</DL>
<DT><A HREF="#lbAJ">DESCRIPTION</A><DD>
<DT><A HREF="#lbAK">OPTIONS</A><DD>
<DT><A HREF="#lbAL">MODES</A><DD>
<DT><A HREF="#lbAM">EXAMPLES</A><DD>
<DT><A HREF="#lbAN">COPYRIGHT</A><DD>
<DT><A HREF="#lbAO">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 21:45:44 GMT, November 14, 2015
</BODY>
</HTML>
