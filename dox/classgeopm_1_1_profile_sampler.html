<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>geopm: geopm::ProfileSampler Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">geopm
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacegeopm.html">geopm</a></li><li class="navelem"><a class="el" href="classgeopm_1_1_profile_sampler.html">ProfileSampler</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classgeopm_1_1_profile_sampler-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">geopm::ProfileSampler Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Retrieves sample data from the set of application ranks on a single node.  
 <a href="classgeopm_1_1_profile_sampler.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_profile_8hpp_source.html">Profile.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for geopm::ProfileSampler:</div>
<div class="dyncontent">
<div class="center"><img src="classgeopm_1_1_profile_sampler__coll__graph.png" border="0" usemap="#geopm_1_1_profile_sampler_coll__map" alt="Collaboration graph"/></div>
<map name="geopm_1_1_profile_sampler_coll__map" id="geopm_1_1_profile_sampler_coll__map">
<area shape="rect" id="node2" href="structgeopm__ctl__message__s.html" title="Structure intended to be shared between the geopm runtime and the application in order to convey stat..." alt="" coords="5,5,164,31"/>
<area shape="rect" id="node3" href="classgeopm_1_1_shared_memory.html" title="This class encapsulates the creation of inter&#45;process shared memory. " alt="" coords="188,5,349,31"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab6d4334184579fdde6ac6aaca6e5c15a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgeopm_1_1_profile_sampler.html#ab6d4334184579fdde6ac6aaca6e5c15a">ProfileSampler</a> (const std::string shm_key_base, size_t table_size)</td></tr>
<tr class="memdesc:ab6d4334184579fdde6ac6aaca6e5c15a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classgeopm_1_1_profile_sampler.html" title="Retrieves sample data from the set of application ranks on a single node. ">ProfileSampler</a> constructor.  <a href="#ab6d4334184579fdde6ac6aaca6e5c15a">More...</a><br /></td></tr>
<tr class="separator:ab6d4334184579fdde6ac6aaca6e5c15a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08570cb6a19fa5ecaf038a71eb1e9467"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgeopm_1_1_profile_sampler.html#a08570cb6a19fa5ecaf038a71eb1e9467">~ProfileSampler</a> (void)</td></tr>
<tr class="memdesc:a08570cb6a19fa5ecaf038a71eb1e9467"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classgeopm_1_1_profile_sampler.html" title="Retrieves sample data from the set of application ranks on a single node. ">ProfileSampler</a> destructor.  <a href="#a08570cb6a19fa5ecaf038a71eb1e9467">More...</a><br /></td></tr>
<tr class="separator:a08570cb6a19fa5ecaf038a71eb1e9467"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae00529830245f88260a4c37eab4b3f31"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgeopm_1_1_profile_sampler.html#ae00529830245f88260a4c37eab4b3f31">capacity</a> (void)</td></tr>
<tr class="memdesc:ae00529830245f88260a4c37eab4b3f31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the maximum capacity of all the per-rank hash tables.  <a href="#ae00529830245f88260a4c37eab4b3f31">More...</a><br /></td></tr>
<tr class="separator:ae00529830245f88260a4c37eab4b3f31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e1599cee82a387dceee290a0f1ff45c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgeopm_1_1_profile_sampler.html#a4e1599cee82a387dceee290a0f1ff45c">sample</a> (std::vector&lt; std::pair&lt; uint64_t, struct <a class="el" href="structgeopm__prof__message__s.html">geopm_prof_message_s</a> &gt; &gt; &amp;content, size_t &amp;length)</td></tr>
<tr class="memdesc:a4e1599cee82a387dceee290a0f1ff45c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the samples present in all the per-rank hash tables.  <a href="#a4e1599cee82a387dceee290a0f1ff45c">More...</a><br /></td></tr>
<tr class="separator:a4e1599cee82a387dceee290a0f1ff45c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a494464a390683c50f795b55397c87a21"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgeopm_1_1_profile_sampler.html#a494464a390683c50f795b55397c87a21">do_shutdown</a> (void)</td></tr>
<tr class="memdesc:a494464a390683c50f795b55397c87a21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the application is shutting down.  <a href="#a494464a390683c50f795b55397c87a21">More...</a><br /></td></tr>
<tr class="separator:a494464a390683c50f795b55397c87a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72a3f7ec863ebfa396756e319e7d702c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgeopm_1_1_profile_sampler.html#a72a3f7ec863ebfa396756e319e7d702c">report</a> (void)</td></tr>
<tr class="memdesc:a72a3f7ec863ebfa396756e319e7d702c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a post-run report for a single node.  <a href="#a72a3f7ec863ebfa396756e319e7d702c">More...</a><br /></td></tr>
<tr class="separator:a72a3f7ec863ebfa396756e319e7d702c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1dd472adcec803f55f34a9db32b0322"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgeopm_1_1_profile_sampler.html#ab1dd472adcec803f55f34a9db32b0322">initialize</a> (void)</td></tr>
<tr class="memdesc:ab1dd472adcec803f55f34a9db32b0322"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize shared memory regions.  <a href="#ab1dd472adcec803f55f34a9db32b0322">More...</a><br /></td></tr>
<tr class="separator:ab1dd472adcec803f55f34a9db32b0322"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ab9556118bd58d494791defe1dabbb925"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classgeopm_1_1_shared_memory.html">SharedMemory</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgeopm_1_1_profile_sampler.html#ab9556118bd58d494791defe1dabbb925">m_ctl_shmem</a></td></tr>
<tr class="separator:ab9556118bd58d494791defe1dabbb925"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab23bdbf7544dedfd0d9ca449461d9f24"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structgeopm__ctl__message__s.html">geopm_ctl_message_s</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgeopm_1_1_profile_sampler.html#ab23bdbf7544dedfd0d9ca449461d9f24">m_ctl_msg</a></td></tr>
<tr class="separator:ab23bdbf7544dedfd0d9ca449461d9f24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2fdfb1a369caea530056d6c845ab00d"><td class="memItemLeft" align="right" valign="top">std::forward_list&lt; <a class="el" href="classgeopm_1_1_profile_rank_sampler.html">ProfileRankSampler</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgeopm_1_1_profile_sampler.html#ad2fdfb1a369caea530056d6c845ab00d">m_rank_sampler</a></td></tr>
<tr class="separator:ad2fdfb1a369caea530056d6c845ab00d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a028032c7686114bce1082e6616357139"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgeopm_1_1_profile_sampler.html#a028032c7686114bce1082e6616357139">m_table_size</a></td></tr>
<tr class="separator:a028032c7686114bce1082e6616357139"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Retrieves sample data from the set of application ranks on a single node. </p>
<p>The <a class="el" href="classgeopm_1_1_profile_sampler.html" title="Retrieves sample data from the set of application ranks on a single node. ">ProfileSampler</a> class is the geopm runtime side interface to the GEOPM profiler. It retrieves samples from all application ranks on a single compute node. It is also the interface to the shared memory region used to coordinate between the geopm runtime and the MPI application. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab6d4334184579fdde6ac6aaca6e5c15a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">geopm::ProfileSampler::ProfileSampler </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>shm_key_base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>table_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classgeopm_1_1_profile_sampler.html" title="Retrieves sample data from the set of application ranks on a single node. ">ProfileSampler</a> constructor. </p>
<p>Constructs a shared memory region for coordination between the geopm runtime and the MPI application.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">shm_key_base</td><td>The shared memory key that will be used to create the control shared memory region. This key will then be appended onto to create shared memory keys for each rank's sample shared memory region.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">table_size</td><td>The size of the hash table that will be created for each application rank. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a08570cb6a19fa5ecaf038a71eb1e9467"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">geopm::ProfileSampler::~ProfileSampler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classgeopm_1_1_profile_sampler.html" title="Retrieves sample data from the set of application ranks on a single node. ">ProfileSampler</a> destructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ae00529830245f88260a4c37eab4b3f31"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t geopm::ProfileSampler::capacity </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the maximum capacity of all the per-rank hash tables. </p>
<dl class="section return"><dt>Returns</dt><dd>The maximum number of samples that can possibly be returned. </dd></dl>

</div>
</div>
<a class="anchor" id="a494464a390683c50f795b55397c87a21"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool geopm::ProfileSampler::do_shutdown </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the application is shutting down. </p>
<p>Queries the control shared memory region to test if the application status in shutdown.</p>
<dl class="section return"><dt>Returns</dt><dd>Return true if application is shutting down, else returns false. </dd></dl>

</div>
</div>
<a class="anchor" id="ab1dd472adcec803f55f34a9db32b0322"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void geopm::ProfileSampler::initialize </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize shared memory regions. </p>
<p>Coordinates with the application to initialize shared memory and create ProfileRankSamplers for each MPI application rank running on the local compute node. </p>

</div>
</div>
<a class="anchor" id="a72a3f7ec863ebfa396756e319e7d702c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void geopm::ProfileSampler::report </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a post-run report for a single node. </p>
<p>Generates a post-run report by telling each <a class="el" href="classgeopm_1_1_profile_rank_sampler.html" title="Retrieves sample data from a single application rank through a shared memory interface. ">ProfileRankSampler</a> to dump its per-region statistics to a file descriptor. </p>

</div>
</div>
<a class="anchor" id="a4e1599cee82a387dceee290a0f1ff45c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void geopm::ProfileSampler::sample </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::pair&lt; uint64_t, struct <a class="el" href="structgeopm__prof__message__s.html">geopm_prof_message_s</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the samples present in all the per-rank hash tables. </p>
<p>Fills in a portion of a vector which is assumed to be already sized greater than or equal to the maximum number of samples we can return. This value can be queried with the <a class="el" href="classgeopm_1_1_profile_sampler.html#ae00529830245f88260a4c37eab4b3f31" title="Retrieve the maximum capacity of all the per-rank hash tables. ">capacity()</a> method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">content</td><td>Vector to be filled with per-node sample messages.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">length</td><td>The number of samples that were inserted. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="ab23bdbf7544dedfd0d9ca449461d9f24"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structgeopm__ctl__message__s.html">geopm_ctl_message_s</a>* geopm::ProfileSampler::m_ctl_msg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Pointer to the control structure used for application coordination and control. </p>

</div>
</div>
<a class="anchor" id="ab9556118bd58d494791defe1dabbb925"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classgeopm_1_1_shared_memory.html">SharedMemory</a> geopm::ProfileSampler::m_ctl_shmem</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Holds the shared memory region used for application coordination and control. </p>

</div>
</div>
<a class="anchor" id="ad2fdfb1a369caea530056d6c845ab00d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::forward_list&lt;<a class="el" href="classgeopm_1_1_profile_rank_sampler.html">ProfileRankSampler</a> *&gt; geopm::ProfileSampler::m_rank_sampler</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>List of per-rank samplers for each MPI application rank running on the local compute node. </p>

</div>
</div>
<a class="anchor" id="a028032c7686114bce1082e6616357139"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t geopm::ProfileSampler::m_table_size</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Size of the hash tables to create for each MPI application rank running on the local compute node.. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="_profile_8hpp_source.html">Profile.hpp</a></li>
<li>src/<a class="el" href="_profile_8cpp.html">Profile.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
